
\section{Implementation}

\paragraph{Motivation}
\begin{itemize}
  \item To match the implementation and to prove that it is correct with respect to our definitions.
\end{itemize}

\subsection{Program Graph Semantics: Finding Models (Masks)}
\begin{definition}[Classical Model Mask]
  Given a program graph $\pg{P} = \langle \Vc \cup \Vd \cup \Va, \Epos, \Eneg \rangle$,
  a subgraph $CM = \langle Vm, Em_{+}, Em_{-} \rangle \subseteq \pg{P}$ is a \emph{classical model mask} of $\pg{P}$
  iff:
  \begin{itemize}
    \item
    $Vm =
      % take the boxes for which we already have all the incoming edges (facts are trivial)
      \{ \ell \in \Vc \cup \Vd \mid \forall (a,\ell) [(a,\ell) \in \Epos \rightarrow (a,\ell) \in Em{+}] \} \cup
    $
    \item $Em_{+} = Em_{+} \cup C_{hoices} \cup \bigcup_{i=1}^{n} A_i
    $

  \begin{itemize}
              % For any choice box already in the graph, take any subset of its outgoing edges
    \item where $C_{hoice} \subseteq \{ (\ell, a) \mid \ell \in Vm \land (\ell, a) \in \Epos \}$
  \end{itemize}
\end{itemize}

\end{definition}
\comment{Map the program from how to build your own asp system and Susana's}

\begin{definition}[(minimal) Model Mask]
  Given a program graph $\pg{P} = \langle \Vc \cup \Vd \cup \Va, \Epos, \Eneg \rangle$,
  we say a valid \emph{classical model mask} $CM = \langle V, \Epos, \Eneg \rangle$ of $\pg{P}$
  is a \emph{(minimal) Model Mask} $MG$ of $\pg{P}$
  iff
  \begin{center}
    $MG$ is $\subseteq-minimal$ among all the \emph{classical model masks} of $\pg{P}$.
  \end{center}
\end{definition}
\comment{Map the program from how to build your own asp system and Susana's}


\comment{S: Given a program graph we can also compute the models. I think this should be made clear somewhere, this is just a sketch, I am not sure how to write it.}
\begin{definition}[Model Subgraph Computed]
  Given a program graph $\pg{P} = \langle \Vc \cup \Vd \cup \Va, \Epos \cup \Eneg \rangle$,
  a \emph{Model Subgraph} is a pair $MG_P^I = \langle V, E \rangle$ such that
  \begin{itemize}
    % Body satisfaction
    \item for any $\ell\in \Vd\cup \Vc$,
    if $a\in V$ for all $(a, \ell) \in \Epos$
    and $a\not\in V$ for all $(a, \ell) \in \Eneg$,
    then $\ell \in V$.

    % Atom satisfied by disjunction
    \item for all $\ell\in \Vd\cap V$ then for (exactly one) $(\ell,a) \in \Epos$ happens $a\in V$.

    % Atom satisfied by choice
    \item for all $\ell\in \Vc\cap V$ then for any $(\ell,a) \in \Epos$, $a\in V$ is optional.


  \end{itemize}
\end{definition}


\paragraph{Discussion points}
\begin{itemize}
  \item This is how asplain collect the model masks
  \item Since the model masks are computed, we mimic the asp semantics, we first go for the classical models and then get the minimal ones.
\end{itemize}
